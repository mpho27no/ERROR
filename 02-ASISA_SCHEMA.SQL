DROP INDEX LC_USER_IDX_1;
DROP INDEX LC_INSURED_PERSON_IDX1;
DROP INDEX LC_INSURED_PERSON_IDX2;
DROP INDEX LC_NOTIFICATION_IDX1;
DROP INDEX LC_NOTIFICATION_IDX2;
DROP INDEX LC_NOTIFIABLE_IMPAIRMENT_IDX1;
DROP INDEX LC_NOTIFIABLE_CLAIM_IDX1;
DROP INDEX LC_NOTE_IDX1;
DROP INDEX LC_NOTE_IDX2;
DROP INDEX LC_NOTIF_IMP_AUDIT_IDX1;
DROP INDEX LC_NOTIF_CLAIM_AUDIT_IDX1;

DROP TABLE LC_USER_ROLE_ACTIVITY;
DROP TABLE LC_USER;
DROP TABLE LC_USER_ACTIVITY;
DROP TABLE LC_USER_ROLE;

DROP TABLE LC_NOTIFIABLE_CLAIM;
DROP TABLE LC_NOTIFIABLE_IMPAIRMENT;
DROP TABLE LC_NOTE;
DROP TABLE LC_NOTIFICATION;
DROP TABLE LC_INSURED_PERSON;

DROP TABLE LC_NOTIFIABLE_CLAIM_AUDIT;
DROP TABLE LC_NOTIFIABLE_IMPAIRMENT_AUDIT;

CREATE TABLE LC_USER_ROLE (
	ROLE_CODE VARCHAR2(20) NOT NULL,
	ROLE_DESC VARCHAR2(60) NOT NULL,
	CREATED_DATE TIMESTAMP NOT NULL,
	IS_ACTIVE  CHAR(1) NULL,
	CONSTRAINT LC_USER_ROLE_PK PRIMARY KEY (ROLE_CODE)
);

CREATE TABLE LC_USER_ACTIVITY (
	ACTIVITY_CODE VARCHAR2(40) NOT NULL,
	ACTIVITY_DESC VARCHAR2(60) NOT NULL,
	CREATED_DATE TIMESTAMP NOT NULL,
	IS_ACTIVE  CHAR(1) NULL,
	CONSTRAINT LC_USER_ACTIVITY_PK PRIMARY KEY (ACTIVITY_CODE)
);

CREATE TABLE LC_USER_ROLE_ACTIVITY (
	ROLE_ACTIVITY_ID INTEGER GENERATED ALWAYS AS IDENTITY (START WITH 1 INCREMENT BY 1) NOT NULL,
	ROLE_CODE VARCHAR2(20) NOT NULL,
	ACTIVITY_CODE VARCHAR2(40) NOT NULL,
	IS_ACTIVE  CHAR(1) NULL,
	CONSTRAINT LC_USER_ROLE_ACTIVITY_PK PRIMARY KEY (ROLE_ACTIVITY_ID),
	CONSTRAINT LC_USER_ROLE_ACTIVITY_UQ UNIQUE (ROLE_CODE, ACTIVITY_CODE),
	CONSTRAINT LC_USER_ROLE_ACTIVITY_FK1 FOREIGN KEY (ROLE_CODE) REFERENCES LC_USER_ROLE (ROLE_CODE),
	CONSTRAINT LC_USER_ROLE_ACTIVITY_FK2 FOREIGN KEY (ACTIVITY_CODE) REFERENCES LC_USER_ACTIVITY (ACTIVITY_CODE)
) ;

CREATE TABLE LC_USER (
	USER_ID INTEGER GENERATED ALWAYS AS IDENTITY (START WITH 1 INCREMENT BY 1) NOT NULL,
	OM_USER_ID VARCHAR2(20) NOT NULL,
	ROLE_CODE VARCHAR2(20) NOT NULL,
	BUSINESS_UNIT VARCHAR2(40) NOT NULL,
	CREATED_DATE TIMESTAMP NOT NULL,
	IS_ACTIVE  CHAR(5) NULL,
	CONSTRAINT LC_USER_PK PRIMARY KEY (USER_ID),
	CONSTRAINT LC_USER_FK1 FOREIGN KEY (ROLE_CODE) REFERENCES LC_USER_ROLE (ROLE_CODE),
	CONSTRAINT OM_USER_ID_ROLE_CODE_UQ UNIQUE (ROLE_CODE, OM_USER_ID)
);

CREATE TABLE LC_INSURED_PERSON (
	ID INTEGER GENERATED ALWAYS AS IDENTITY (START WITH 1 INCREMENT BY 1) NOT NULL,
	PERSON_ID  VARCHAR2(36) NOT NULL,
	IDENTITY_NUMBER_TYPE_CODE VARCHAR2(20) NULL,
	IDENTITY_NUMBER VARCHAR2(20) NULL,
	DATE_OF_BIRTH DATE NOT NULL,
	GENDER VARCHAR2(10) NOT NULL,
	TITLE VARCHAR2(10) NOT NULL,
	SURNAME VARCHAR2(60) NOT NULL,
	GIVEN_NAME_1 VARCHAR2(66) NULL,
	GIVEN_NAME_2 VARCHAR2(66) NULL,
	GIVEN_NAME_3 VARCHAR2(66) NULL,
	ADDRESS_LINE_1 VARCHAR2(30) NULL,
	ADDRESS_LINE_2 VARCHAR2(30) NULL,
	ADDRESS_LINE_3 VARCHAR2(30) NULL,
	POSTAL_CODE VARCHAR2(10) NULL,
	CREATED_BY VARCHAR2(36) NULL,
	CREATED_DATE TIMESTAMP NOT NULL,
	OFFICE_CODE INTEGER NOT NULL,
	IS_ACTIVE CHAR(1) NULL,
	SOURCE VARCHAR2(10) NULL,
	CONSTRAINT LC_INSURED_PERSON_PK PRIMARY KEY (PERSON_ID)
) ;

CREATE TABLE LC_NOTIFICATION (
	NOTIFICATION_ID  VARCHAR2(36) NOT NULL,
	PERSON_ID  VARCHAR2(36) NOT NULL,
	NOTIFICATION_SOURCE VARCHAR2(60) NULL, 
	NOTIFICATION_TYPE_CODE VARCHAR2(10) NOT NULL, 
	NOTIFICATION_TXN_TYPE VARCHAR2(20) NULL, 
	NOTIFICATION_STATUS_CODE VARCHAR2(20) NOT NULL,
	POLICY_REF_NUMBER VARCHAR2(20) NULL,
	POLICY_TYPE_CODE VARCHAR2(20) NULL,
	CREATED_BY VARCHAR2(36) NOT NULL,
	CREATED_DATE TIMESTAMP NOT NULL,
	ASTUTE_REF_NO VARCHAR2(255) NULL, 
	IS_ACTIVE  CHAR(1) NULL,
	CONSTRAINT LC_NOTIFICATION_PK PRIMARY KEY (NOTIFICATION_ID),
	CONSTRAINT LC_NOTIFICATION_FK1 FOREIGN KEY (PERSON_ID) REFERENCES LC_INSURED_PERSON (PERSON_ID)
);

CREATE TABLE LC_NOTIFIABLE_IMPAIRMENT (
	NOTIFIABLE_IMPAIRMENT_ID INTEGER GENERATED ALWAYS AS IDENTITY (START WITH 1 INCREMENT BY 1) NOT NULL,
	NOTIFICATION_ID  VARCHAR2(36)  NOT NULL,
	IMPAIRMENT_CODE VARCHAR2(10) NOT NULL,
	TIME_SIGNAL VARCHAR2(25) NULL,
	READINGS VARCHAR2(40) NULL,
	LIFE_SPEC_CODES VARCHAR2(255) NULL,
	LIFE_SYMBOL_CODES VARCHAR2(255) NULL,
	REASON_FOR_EDIT VARCHAR2(255) NULL,
	CONSTRAINT LC_NOTIFIABLE_IMPAIRMENT_PK PRIMARY KEY (NOTIFIABLE_IMPAIRMENT_ID),
	CONSTRAINT LC_NOTIFIABLE_IMPAIRMENT_FK1 FOREIGN KEY (NOTIFICATION_ID) REFERENCES LC_NOTIFICATION (NOTIFICATION_ID)
);

CREATE TABLE LC_NOTIFIABLE_CLAIM (
	NOTIFIABLE_CLAIM_ID INTEGER GENERATED ALWAYS AS IDENTITY (START WITH 1 INCREMENT BY 1) NOT NULL,
	NOTIFICATION_ID  VARCHAR2(36)  NOT NULL,
	CLAIM_CATEGORY_CODE VARCHAR2(20) NULL,
	EVENT_DATE DATE NULL,	
	EVENT_CAUSE_CODE VARCHAR2(50) NULL,
	EVENT_DEATH_PLACE VARCHAR2(40) NULL,
	EVENT_DEATH_CERTIFICATE_NO VARCHAR2(40) NULL,
	DHA1663_NUMBER VARCHAR2(40) NULL,
	CLAIM_REASON_CODES VARCHAR2(255) NULL,
	CLAIM_STATUS_CODE VARCHAR2(20) NULL,
	PAYMENT_METHOD_CODE VARCHAR2(40) NULL,
	REASON_FOR_EDIT VARCHAR2(255) NULL,	
 	CONSTRAINT LC_NOTIFIABLE_CLAIM_PK PRIMARY KEY (NOTIFIABLE_CLAIM_ID),
	CONSTRAINT LC_NOTIFIABLE_CLAIM_FK1 FOREIGN KEY (NOTIFICATION_ID) REFERENCES LC_NOTIFICATION (NOTIFICATION_ID)
 );
 
 CREATE TABLE LC_NOTE (
	NOTE_ID INTEGER GENERATED ALWAYS AS IDENTITY (START WITH 1 INCREMENT BY 1) NOT NULL,
	NOTIFICATION_ID  VARCHAR2(36) NULL,
	PERSON_ID  VARCHAR2(36) NULL,
	NOTE_TEXT VARCHAR2(800) NOT NULL,
	IS_SCRATCHPAD CHAR(1) NOT NULL,
	IS_ACTIVE CHAR(1) NULL,
	CREATED_DATE TIMESTAMP NOT NULL, 
	CONSTRAINT LC_NOTE_PK PRIMARY KEY (NOTE_ID),
	CONSTRAINT LC_NOTE_FK1 FOREIGN KEY (NOTIFICATION_ID) REFERENCES LC_NOTIFICATION (NOTIFICATION_ID),
	CONSTRAINT LC_NOTE_FK2 FOREIGN KEY (PERSON_ID) REFERENCES LC_INSURED_PERSON (PERSON_ID)
);

-- AUDIT TABLES: INSERT A RECORD FOR EVERY ACTION (INSERT, UPDATE, DELETE) ON THE SOURCE TABLE
CREATE TABLE LC_NOTIFIABLE_IMPAIRMENT_AUDIT (
	NOTIFIABLE_IMPAIRMENT_AUDIT_ID INTEGER GENERATED ALWAYS AS IDENTITY (START WITH 1 INCREMENT BY 1) NOT NULL,
	NOTIFICATION_ID  VARCHAR2(36)  NOT NULL,
	IMPAIRMENT_CODE VARCHAR2(10) NOT NULL,
	TIME_SIGNAL VARCHAR2(25) NULL,
	READINGS VARCHAR2(40) NULL,
	LIFE_SPEC_CODES VARCHAR2(255) NULL,
	LIFE_SYMBOL_CODES VARCHAR2(255) NULL,
	REASON_FOR_EDIT VARCHAR2(255) NULL,
	NOTIFICATION_STATUS_CODE VARCHAR2(20) NOT NULL,
	NOTIFICATION_TXN_TYPE VARCHAR2(20) NOT NULL,
	ASTUTE_REF_NO VARCHAR2(255) NULL,
	CREATED_BY VARCHAR2(36) NOT NULL,
	CREATED_DATE TIMESTAMP NOT NULL,
	IS_ACTIVE CHAR(1) NULL,
	CONSTRAINT LC_NOTIF_IMPAIR_AUDIT_PK PRIMARY KEY (NOTIFIABLE_IMPAIRMENT_AUDIT_ID)
);

CREATE TABLE LC_NOTIFIABLE_CLAIM_AUDIT (
	NOTIFIABLE_CLAIM_AUDIT_ID INTEGER GENERATED ALWAYS AS IDENTITY (START WITH 1 INCREMENT BY 1) NOT NULL,	
	NOTIFICATION_ID  VARCHAR2(36)  NOT NULL,
	CLAIM_CATEGORY_CODE VARCHAR2(20) NULL,
	EVENT_DATE DATE NULL,	
	EVENT_CAUSE_CODE VARCHAR2(50) NULL,
	EVENT_DEATH_PLACE VARCHAR2(40) NULL,
	EVENT_DEATH_CERTIFICATE_NO VARCHAR2(40) NULL,
	DHA1663_NUMBER VARCHAR2(40) NULL,
	CLAIM_REASON_CODES VARCHAR2(255) NULL,
	CLAIM_STATUS_CODE VARCHAR2(20) NULL,
	PAYMENT_METHOD_CODE VARCHAR2(40) NULL,
	REASON_FOR_EDIT VARCHAR2(255) NULL,	
	NOTIFICATION_STATUS_CODE VARCHAR2(20) NOT NULL,
	NOTIFICATION_TXN_TYPE VARCHAR2(20) NOT NULL,
	ASTUTE_REF_NO VARCHAR2(255) NULL,
	CREATED_BY VARCHAR2(36) NOT NULL,
	CREATED_DATE TIMESTAMP NOT NULL,
	IS_ACTIVE CHAR(1) NULL,
	CONSTRAINT LC_NOTIF_CLAIM_AUDIT_PK PRIMARY KEY (NOTIFIABLE_CLAIM_AUDIT_ID)
 );

CREATE INDEX LC_USER_IDX_1 ON LC_USER (OM_USER_ID);
CREATE INDEX LC_INSURED_PERSON_IDX1 ON LC_INSURED_PERSON (IDENTITY_NUMBER_TYPE_CODE, IDENTITY_NUMBER) ; 
CREATE INDEX LC_INSURED_PERSON_IDX2 ON LC_INSURED_PERSON (DATE_OF_BIRTH, SURNAME) ;
CREATE INDEX LC_NOTIFICATION_IDX1 ON LC_NOTIFICATION (PERSON_ID) ;
CREATE INDEX LC_NOTIFICATION_IDX2 ON LC_NOTIFICATION (PERSON_ID, NOTIFICATION_ID) ;
CREATE INDEX LC_NOTIFIABLE_IMPAIRMENT_IDX1 ON LC_NOTIFIABLE_IMPAIRMENT (NOTIFICATION_ID)  ;
CREATE INDEX LC_NOTIFIABLE_CLAIM_IDX1 ON LC_NOTIFIABLE_CLAIM (NOTIFICATION_ID) ;
CREATE INDEX LC_NOTE_IDX1 ON LC_NOTE (PERSON_ID) ;
CREATE INDEX LC_NOTE_IDX2 ON LC_NOTE (PERSON_ID, NOTIFICATION_ID)  ;
CREATE INDEX LC_NOTIF_IMP_AUDIT_IDX1 ON LC_NOTIFIABLE_IMPAIRMENT_AUDIT (NOTIFICATION_ID);
CREATE INDEX LC_NOTIF_CLAIM_AUDIT_IDX1 ON LC_NOTIFIABLE_CLAIM_AUDIT (NOTIFICATION_ID)  ;